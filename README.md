# –ë–æ—Ç –∑–∞ –Ω–æ–≤–∏–Ω–∏ –æ—Ç –¥–µ—Ç—Å–∫–∏ –≥—Ä–∞–¥–∏–Ω–∏ –≤ –ü–ª–æ–≤–¥–∏–≤ üè´

Viber –±–æ—Ç, –∫–æ–π—Ç–æ —Å–ª–µ–¥–∏ —Å–∞–π—Ç–∞ –Ω–∞ –æ–±—â–∏–Ω–∞ –ü–ª–æ–≤–¥–∏–≤ –∑–∞ –Ω–æ–≤–∏–Ω–∏ —Å–≤—ä—Ä–∑–∞–Ω–∏ —Å –¥–µ—Ç—Å–∫–∏ –≥—Ä–∞–¥–∏–Ω–∏ –∏ —è—Å–ª–∏, –∏ —É–≤–µ–¥–æ–º—è–≤–∞ —Ä–æ–¥–∏—Ç–µ–ª–∏—Ç–µ –≤ –≥—Ä—É–ø–æ–≤ —á–∞—Ç.

## –§—É–Ω–∫—Ü–∏–∏

- –°–ª–µ–¥–∏ `dz-priem.plovdiv.bg/news` –∑–∞ –Ω–æ–≤–∏ —Å—Ç–∞—Ç–∏–∏
- –ó–∞–ø–æ–º–Ω—è –≤–µ—á–µ –≤–∏–¥–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç–∏–∏, –∑–∞ –¥–∞ –Ω–µ –∏–∑–ø—Ä–∞—â–∞ –¥—É–±–ª–∏–∫–∞—Ç–∏
- –ò–∑–ø—Ä–∞—â–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–∏ —Å—ä–æ–±—â–µ–Ω–∏—è —á—Ä–µ–∑ Viber Bot API
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω –¥–∞ —Ä–∞–±–æ—Ç–∏ –≤–µ–¥–Ω—ä–∂ –¥–Ω–µ–≤–Ω–æ –≤ 15:00 (–Ω–∞—Å—Ç—Ä–æ–π–≤–∞–µ–º–æ)
- –ë–∞–∑–∏—Ä–∞–Ω –Ω–∞ Docker –∑–∞ –ª–µ—Å–Ω–æ —Ä–∞–∑–≥—Ä—ä—â–∞–Ω–µ –Ω–∞ unRAID –∏–ª–∏ –¥—Ä—É–≥ —Å—ä—Ä–≤—ä—Ä

## –ë—ä—Ä–∑ —Å—Ç–∞—Ä—Ç

### 1. –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ Viber –±–æ—Ç

1. –û—Ç–∏–¥–µ—Ç–µ –Ω–∞ [Viber Admin Panel](https://partners.viber.com/)
2. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ –±–æ—Ç –∞–∫–∞—É–Ω—Ç
3. –ö–æ–ø–∏—Ä–∞–π—Ç–µ —Ç–æ–∫–µ–Ω–∞ –∑–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è

### 2. –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ Chat ID

–ó–∞ **–≥—Ä—É–ø–æ–≤–∏ —á–∞—Ç–æ–≤–µ** –±–æ—Ç—ä—Ç —Ç—Ä—è–±–≤–∞ –ø—ä—Ä–≤–æ –¥–∞ –±—ä–¥–µ –¥–æ–±–∞–≤–µ–Ω –≤ –≥—Ä—É–ø–∞—Ç–∞. –ö–æ–≥–∞—Ç–æ –Ω—è–∫–æ–π –∏–∑–ø—Ä–∞—Ç–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ –¥–æ–∫–∞—Ç–æ –±–æ—Ç—ä—Ç –µ –≤ –≥—Ä—É–ø–∞—Ç–∞, ID-—Ç–æ –Ω–∞ –≥—Ä—É–ø–∞—Ç–∞ —â–µ —Å–µ –ø–æ—è–≤–∏ –≤ webhook —Å—ä–±–∏—Ç–∏—è—Ç–∞.

–ó–∞ **–ª–∏—á–Ω–∏ —Å—ä–æ–±—â–µ–Ω–∏—è** –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Viber user ID –Ω–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
cp .env.example .env
# –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π—Ç–µ .env —Å –≤–∞—à–∏—Ç–µ –¥–∞–Ω–Ω–∏
```

### 4. –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ

**–¢–µ—Å—Ç–æ–≤–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ (–±–µ–∑ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Å—ä–æ–±—â–µ–Ω–∏—è):**
```bash
docker compose run --rm -e DRY_RUN=true plovdiv-school-news-bot
```

**–ü—Ä–æ–¥—É–∫—Ü–∏–æ–Ω–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ:**
```bash
docker compose run --rm plovdiv-school-news-bot
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ unRAID

### –í–∞—Ä–∏–∞–Ω—Ç 1: User Scripts Plugin

1. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π—Ç–µ "User Scripts" –æ—Ç Community Applications
2. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ —Å–∫—Ä–∏–ø—Ç —Å—ä—Å —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ:

```bash
#!/bin/bash
cd /mnt/user/appdata/plovdiv-school-news-bot
docker compose run --rm plovdiv-school-news-bot
```

3. –ó–∞–¥–∞–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ "Custom" —Å cron: `0 15 * * *` (15:00 –≤—Å–µ–∫–∏ –¥–µ–Ω)

### –í–∞—Ä–∏–∞–Ω—Ç 2: Cron Job

–î–æ–±–∞–≤–µ—Ç–µ –≤ `/boot/config/go` –∏–ª–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ cron –º–µ–Ω–∏–¥–∂—ä—Ä–∞:

```bash
0 15 * * * docker run --rm \
  -e VIBER_BOT_TOKEN=xxx \
  -e VIBER_CHAT_ID=xxx \
  -v /mnt/user/appdata/plovdiv-school-news-bot/data:/data \
  ghcr.io/ownzi/plovdiv-school-news-bot:latest
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü—Ä–æ–º–µ–Ω–ª–∏–≤–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ |
|------------|----------|-----------------|
| `VIBER_BOT_TOKEN` | Viber Bot API —Ç–æ–∫–µ–Ω (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω) | - |
| `VIBER_CHAT_ID` | Viber —á–∞—Ç/–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª ID –∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω) | - |
| `NEWS_URL` | URL –∑–∞ —Å–ª–µ–¥–µ–Ω–µ –Ω–∞ –Ω–æ–≤–∏–Ω–∏ | `https://dz-priem.plovdiv.bg/news` |
| `STATE_FILE` | –ü—ä—Ç –¥–æ —Ñ–∞–π–ª–∞ –∑–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ | `/data/seen_articles.json` |
| `DRY_RUN` | –ê–∫–æ –µ `true`, –Ω–µ –∏–∑–ø—Ä–∞—â–∞ —Å—ä–æ–±—â–µ–Ω–∏—è | `false` |
| `TZ` | –ß–∞—Å–æ–≤–∞ –∑–æ–Ω–∞ –∑–∞ –ª–æ–≥–æ–≤–µ—Ç–µ | `Europe/Sofia` |

## –°—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∞–Ω–Ω–∏

–ë–æ—Ç—ä—Ç —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ ID-—Ç–∞—Ç–∞ –Ω–∞ –≤–∏–¥–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç–∏–∏ –≤ `/data/seen_articles.json`. –ú–æ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Ç–æ–≤–∞ –∫–∞—Ç–æ volume, –∑–∞ –¥–∞ –∑–∞–ø–∞–∑–∏—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–∏—è—Ç–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –õ–æ–∫–∞–ª–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ
python -m src.main

# –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–µ
pytest tests/
```

## –ë–µ–ª–µ–∂–∫–∏ –∑–∞ Viber Bot API

- Viber –±–æ—Ç–æ–≤–µ—Ç–µ –∏–∑–∏—Å–∫–≤–∞—Ç webhook –∑–∞ –ø–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ —Å—ä–æ–±—â–µ–Ω–∏—è, –Ω–æ —Ç–æ–∑–∏ –±–æ—Ç —Å–∞–º–æ **–∏–∑–ø—Ä–∞—â–∞** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ó–∞ –≥—Ä—É–ø–æ–≤–∏ —á–∞—Ç–æ–≤–µ –±–æ—Ç—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –¥–æ–±–∞–≤–µ–Ω –∫–∞—Ç–æ —á–ª–µ–Ω
- –õ–∏–º–∏—Ç–∏: 20 –∑–∞—è–≤–∫–∏/—Å–µ–∫—É–Ω–¥–∞ –∑–∞ —Å—ä–æ–±—â–µ–Ω–∏—è
- –°—ä–æ–±—â–µ–Ω–∏—è—Ç–∞ –ø–æ–¥–¥—ä—Ä–∂–∞—Ç —Ç–µ–∫—Å—Ç, URL-–∏ –∏ rich media

### –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ Group Chat ID

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook endpoint (–¥–æ—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ)
2. –î–æ–±–∞–≤–µ—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–∞—Ç–∞
3. –ò–∑–ø—Ä–∞—Ç–µ—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–ª–Ω–æ —Å—ä–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–∞—Ç–∞
4. Webhook-—ä—Ç —â–µ –ø–æ–ª—É—á–∏ —Å—ä–±–∏—Ç–∏–µ —Å `chat_id` –≤ payload-–∞

–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ç–æ–∑–∏ –º–∏–Ω–∏–º–∞–ª–µ–Ω webhook –∑–∞ —É–ª–∞–≤—è–Ω–µ –Ω–∞ ID-—Ç–æ:

```python
from flask import Flask, request
app = Flask(__name__)

@app.route('/viber', methods=['POST'])
def viber_webhook():
    data = request.json
    print(f"–°—ä–±–∏—Ç–∏–µ: {data}")
    if 'chat' in data:
        print(f"Chat ID: {data['chat']['id']}")
    return 'ok'

if __name__ == '__main__':
    app.run(port=8080)
```

## –õ–∏—Ü–µ–Ω–∑

MIT
